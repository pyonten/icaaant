<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>I CAAAN’T – icaaant.de</title>
  <meta name="description" content="Eine kleine, lustige Ein-Seiten-Site zum Brave-Mädchen-Podcast-Meme: i caaaan’t." />
  <style>
    body {
      margin:0;
      font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
      background:#0b0b10;
      color:#eef2ff;
    }
    .container { max-width:700px;padding:20px;text-align:center }
    .big { font-size:clamp(32px,8vw,96px);font-weight:900;margin:20px 0 }
    .btn {
      appearance:none;
      border:0;
      background:linear-gradient(180deg,#8b5cf6,#6d28d9);
      color:white;
      padding:10px 14px;
      border-radius:12px;
      font-weight:700;
      cursor:pointer;
      box-shadow:0 6px 18px rgba(139,92,246,.35);
      transition:transform .08s
    }
    .btn:active{transform:translateY(1px)}
    .controls{margin-top:20px}
    label{margin:0 6px}
    input[type=number]{width:60px}
  </style>
</head>
<body>
  <div class="container">
    <div id="meme" class="big">I caaaaan’t</div>
    <p>Zieh am Regler oder halte den Button für Audio:</p>
    <input id="slider" type="range" min="1" max="30" value="4" />
    <div class="controls">
      <label>Loop Start (s): <input id="loopStart" type="number" step="0.01" value="0.50"></label>
      <label>Loop Ende (s): <input id="loopEnd" type="number" step="0.01" value="1.20"></label>
    </div>
    <br>
    <button id="audioBtn" class="btn">▶️ Halten zum Ziehen</button>
    <p id="status"></p>
    <audio id="audio" src="icaaant.mp3" preload="auto" crossorigin="anonymous"></audio>
  </div>

  <script>
    const meme = document.getElementById('meme');
    const slider = document.getElementById('slider');
    const audioBtn = document.getElementById('audioBtn');
    const audio = document.getElementById('audio');
    const loopStartEl = document.getElementById('loopStart');
    const loopEndEl = document.getElementById('loopEnd');
    const statusEl = document.getElementById('status');

    function buildPhrase(n){
      const a = 'a'.repeat(Math.max(1, n|0));
      return `I c${a}an’t`;
    }
    function setCount(n){
      slider.value = n;
      meme.textContent = buildPhrase(n);
    }
    slider.addEventListener('input', e => setCount(e.target.value));

    let audioCtx, srcNode;
    async function ensureCtx(){
      if(!audioCtx){ audioCtx = new (window.AudioContext||window.webkitAudioContext)(); }
      if(audioCtx.state==='suspended'){ await audioCtx.resume(); }
      if(!srcNode){ srcNode = audioCtx.createMediaElementSource(audio); srcNode.connect(audioCtx.destination); }
    }
    function applyLoop(){
      const ls=parseFloat(loopStartEl.value)||0.5;
      const le=parseFloat(loopEndEl.value)||1.2;
      audio.loopStart=ls; audio.loopEnd=le;
    }
    loopStartEl.addEventListener('input', applyLoop);
    loopEndEl.addEventListener('input', applyLoop);

    let holding=false;
    async function startHeldPlay(){
      await ensureCtx(); applyLoop();
      audio.currentTime=0; audio.loop=false; audio.playbackRate=1.0;
      statusEl.textContent='Spiele… (halten zum Strecken)';
      audio.play().catch(()=>{});
      audio.addEventListener('timeupdate', ()=>{
        if(holding && audio.currentTime>=audio.loopStart && !audio.loop){
          audio.loop=true; audio.currentTime=audio.loopStart;
        }
      });
    }
    function stopHeldPlay(){
      audio.loop=false;
      if(audio.currentTime<audio.loopEnd){ audio.currentTime=audio.loopEnd+0.02; }
      statusEl.textContent='Ausklang…';
    }

    audioBtn.addEventListener('pointerdown', ()=>{ holding=true; startHeldPlay(); });
    window.addEventListener('pointerup', ()=>{ if(holding){ holding=false; stopHeldPlay(); }});

    audio.addEventListener('ended', ()=> statusEl.textContent='');

    setCount(4);
  </script>
</body>
</html>
